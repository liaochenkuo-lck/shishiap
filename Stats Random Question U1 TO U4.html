<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AP统计学概念抽取器（1-4单元）</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        // 配置Tailwind自定义样式
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF', // 主色调：蓝色（专业感）
                        unit1: '#FF6B35',   // 单元1：橙色
                        unit2: '#2ECC71',   // 单元2：绿色
                        unit3: '#9B59B6',   // 单元3：紫色
                        unit4: '#3498DB',   // 单元4：亮蓝
                    },
                    fontFamily: {
                        comic: ['"Comic Sans MS"', 'cursive', 'sans-serif'],
                    },
                    animation: {
                        'bounce-slow': 'bounce 2s infinite',
                        'spin-slow': 'spin 3s linear infinite',
                        'pop': 'pop 0.5s ease-out',
                    },
                    keyframes: {
                        pop: {
                            '0%': { transform: 'scale(0.8)', opacity: '0' },
                            '50%': { transform: 'scale(1.1)' },
                            '100%': { transform: 'scale(1)', opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            }
            .card-hover {
                @apply transition-all duration-300 hover:shadow-xl hover:-translate-y-1;
            }
            .btn-custom {
                @apply rounded-full px-6 py-3 font-bold text-white shadow-lg transition-all duration-300 hover:shadow-xl hover:-translate-y-0.5;
            }
            .timer-btn {
                @apply px-4 py-2 rounded-lg transition-all text-center font-medium;
            }
            .timer-btn-active {
                @apply bg-primary text-white;
            }
            .timer-btn-inactive {
                @apply bg-primary/20 hover:bg-primary/40 text-primary;
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-50 min-h-screen font-comic">
    <!-- 音效元素 -->
    <audio id="drawSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.mp3" type="audio/mpeg">
    </audio>
    <audio id="timerEndSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3" type="audio/mpeg">
    </audio>
    <audio id="clickSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3" type="audio/mpeg">
    </audio>

    <!-- 页面头部 -->
    <header class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4 flex flex-col md:flex-row justify-between items-center">
            <div class="flex items-center mb-4 md:mb-0">
                <i class="fa fa-bar-chart text-primary text-4xl mr-3 animate-spin-slow"></i>
                <h1 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold text-primary text-shadow">
                    AP统计学概念抽取器
                </h1>
            </div>
            <div class="text-sm text-gray-500">
                <p>共4个单元 · 76个核心概念</p>
            </div>
        </div>
    </header>

    <!-- 主要内容区 -->
    <main class="container mx-auto px-4 py-8">
        <!-- 筛选与抽取区 -->
        <section class="mb-12 bg-white rounded-2xl shadow-lg p-6">
            <div class="flex flex-col md:flex-row gap-6">
                <!-- 单元筛选 -->
                <div class="w-full md:w-1/3 bg-gray-50 rounded-xl p-5">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fa fa-list-ul text-primary mr-2"></i>选择单元
                    </h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                        <!-- 单元1 -->
                        <label class="flex items-center p-3 rounded-lg border-2 border-transparent hover:border-unit1 cursor-pointer transition-all">
                            <input type="checkbox" value="1" class="form-checkbox h-5 w-5 text-unit1 mr-2" checked>
                            <span class="font-medium text-unit1">单元1：探索数据</span>
                        </label>
                        <!-- 单元2 -->
                        <label class="flex items-center p-3 rounded-lg border-2 border-transparent hover:border-unit2 cursor-pointer transition-all">
                            <input type="checkbox" value="2" class="form-checkbox h-5 w-5 text-unit2 mr-2" checked>
                            <span class="font-medium text-unit2">单元2：实验设计</span>
                        </label>
                        <!-- 单元3 -->
                        <label class="flex items-center p-3 rounded-lg border-2 border-transparent hover:border-unit3 cursor-pointer transition-all">
                            <input type="checkbox" value="3" class="form-checkbox h-5 w-5 text-unit3 mr-2" checked>
                            <span class="font-medium text-unit3">单元3：概率基础</span>
                        </label>
                        <!-- 单元4 -->
                        <label class="flex items-center p-3 rounded-lg border-2 border-transparent hover:border-unit4 cursor-pointer transition-all">
                            <input type="checkbox" value="4" class="form-checkbox h-5 w-5 text-unit4 mr-2" checked>
                            <span class="font-medium text-unit4">单元4：概率分布</span>
                        </label>
                    </div>
                    
                    <!-- 倒计时设置 -->
                    <div class="mt-6">
                        <h3 class="text-lg font-bold text-gray-800 mb-3 flex items-center">
                            <i class="fa fa-clock-o text-primary mr-2"></i>显示设置
                        </h3>
                        <p class="text-sm text-gray-600 mb-2">概念解释的显示方式：</p>
                        <div class="flex flex-wrap gap-2">
                            <button class="timer-option timer-btn timer-btn-inactive" data-seconds="30">30秒后显示</button>
                            <button class="timer-option timer-btn timer-btn-active" data-seconds="60">1分钟后显示</button>
                            <button class="timer-option timer-btn timer-btn-inactive" data-seconds="120">2分钟后显示</button>
                            <button class="timer-option timer-btn timer-btn-inactive" data-seconds="0">直接显示</button>
                        </div>
                    </div>
                    
                    <div class="mt-4 flex gap-3">
                        <button id="selectAll" class="btn-custom bg-primary/80 hover:bg-primary">
                            <i class="fa fa-check-square-o mr-1"></i>全选
                        </button>
                        <button id="deselectAll" class="btn-custom bg-gray-500 hover:bg-gray-600">
                            <i class="fa fa-square-o mr-1"></i>全不选
                        </button>
                    </div>
                </div>

                <!-- 抽取按钮与结果显示 -->
                <div class="w-full md:w-2/3 flex flex-col items-center justify-center">
                    <button id="randomBtn" class="btn-custom bg-primary text-[clamp(1rem,2vw,1.25rem)] px-10 py-4 mb-8 animate-bounce-slow">
                        <i class="fa fa-random mr-2"></i>随机抽取概念
                    </button>

                    <!-- 概念结果卡片 -->
                    <div id="conceptCard" class="w-full bg-white rounded-xl shadow-lg border-4 border-primary/30 p-6 card-hover hidden animate-pop">
                        <div id="conceptUnit" class="text-sm font-bold px-3 py-1 rounded-full inline-block mb-3 bg-primary/10 text-primary">
                            单元1：探索数据
                        </div>
                        <h3 id="conceptName" class="text-[clamp(1.5rem,3vw,2rem)] font-bold text-gray-800 mb-4 text-center">
                            Categorical Variable（分类变量）
                        </h3>
                        
                        <!-- 倒计时区域 -->
                        <div id="timerContainer" class="bg-yellow-50 rounded-lg p-4 mb-4 hidden">
                            <h4 class="font-bold text-yellow-700 mb-2 flex items-center">
                                <i class="fa fa-hourglass-half mr-2"></i>概念解释将在：
                            </h4>
                            <div class="flex items-center">
                                <span id="countdown" class="text-2xl font-bold text-yellow-600">01:00</span>
                                <div class="w-full ml-4 bg-gray-200 rounded-full h-2.5">
                                    <div id="timerBar" class="bg-yellow-500 h-2.5 rounded-full transition-all duration-1000" style="width: 100%"></div>
                                </div>
                            </div>
                            <button id="showNowBtn" class="mt-2 text-sm text-blue-600 hover:underline">
                                <i class="fa fa-eye mr-1"></i>立即查看
                            </button>
                        </div>
                        
                        <!-- 解释区域 -->
                        <div id="explanationContainer" class="bg-gray-50 rounded-lg p-4 mb-4 hidden">
                            <h4 class="font-bold text-gray-700 mb-2 flex items-center">
                                <i class="fa fa-book text-primary mr-2"></i>概念解释：
                            </h4>
                            <p id="conceptDesc" class="text-gray-600">
                                描述个体的类别或分组的变量，其值为标签或名称，而非数字。例如：性别（男/女）、血型（A/B/AB/O）等。
                            </p>
                        </div>
                        
                        <div class="flex justify-between items-center">
                            <span id="conceptCount" class="text-gray-500">
                                已抽取：0/76
                            </span>
                            <button id="nextBtn" class="btn-custom bg-primary/90 hover:bg-primary">
                                <i class="fa fa-refresh mr-1"></i>再抽一个
                            </button>
                        </div>
                    </div>

                    <!-- 初始提示 -->
                    <div id="initialHint" class="text-center text-gray-500 py-10">
                        <i class="fa fa-lightbulb-o text-5xl text-primary/50 mb-4"></i>
                        <p class="text-xl">选择要抽取的单元，点击上方按钮开始随机抽取</p>
                        <p class="mt-2">每个概念包含单元分类、英文名称和详细解释</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 已抽取概念记录 -->
        <section class="bg-white rounded-2xl shadow-lg p-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                <i class="fa fa-history text-primary mr-2"></i>已抽取概念记录
            </h2>
            <div id="historyList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 max-h-64 overflow-y-auto p-2">
                <div class="text-gray-500 text-center col-span-full py-8">
                    暂无抽取记录，开始抽取后将显示在这里
                </div>
            </div>
        </section>
    </main>

    <!-- 页脚 -->
    <footer class="bg-gray-800 text-white py-6 mt-12">
        <div class="container mx-auto px-4 text-center">
            <p class="mb-2">AP统计学概念随机抽取器 | 1-4单元专用版</p>
            <p class="text-sm text-gray-400">设计目标：帮助学生快速记忆统计学核心概念</p>
        </div>
    </footer>

    <script>
        // 音效元素
        const drawSound = document.getElementById('drawSound');
        const timerEndSound = document.getElementById('timerEndSound');
        const clickSound = document.getElementById('clickSound');
        
        // 播放音效的函数
        function playSound(sound) {
            // 克隆音效元素以允许连续播放
            const clone = sound.cloneNode();
            clone.play().catch(e => console.log("Audio play failed:", e));
            // 播放结束后清理
            clone.addEventListener('ended', () => clone.remove());
        }

        // 统计学概念数据（1-4单元）
        const statsConcepts = {
            1: [
                { name: "Categorical Variable（分类变量）", desc: "描述个体的类别或分组的变量，其值为标签或名称，而非数字。例如：性别（男/女）、血型（A/B/AB/O）等。" },
                { name: "Quantitative Variable（定量变量）", desc: "取值为数值的变量，这些数值具有数学意义（可以进行加减等运算）。例如：身高、体重、年龄等。" },
                { name: "Discrete Variable（离散变量）", desc: "只能取特定数值的定量变量，通常是计数结果，数值之间存在间隔。例如：一个家庭的孩子数量、骰子的点数等。" },
                { name: "Continuous Variable（连续变量）", desc: "可以在一个区间内取任何数值的定量变量，通常是测量结果，可以无限细分。例如：身高、体重、时间等。" },
                { name: "Univariate Data（单变量数据）", desc: "只涉及一个变量的数据集合，用于研究该单个变量的分布和特征。例如：一个班级所有学生的身高数据。" },
                { name: "Bivariate Data（双变量数据）", desc: "涉及两个变量的数据集合，用于研究两个变量之间的关系。例如：一组学生的身高和体重数据。" },
                { name: "Distribution of a Variable（变量的分布）", desc: "描述变量所有可能取值以及这些取值出现的频率或概率的情况，包括形状、中心和分布范围三个主要特征。" },
                { name: "Frequency Table（频数表）", desc: "将数据按类别或区间分组，并记录每个组中观测值数量（频数）的表格，用于汇总和简化数据。" },
                { name: "Bar Graph（条形图）", desc: "用于展示分类变量分布的图形，横轴表示类别，纵轴表示频数或频率，每个类别用一个矩形条表示，条的高度与频数成正比。" },
                { name: "Pie Chart（饼图）", desc: "用于展示分类变量分布的图形，整个圆代表数据的总和（100%），每个扇形的大小与相应类别的比例成正比。" },
                { name: "Pareto Chart（帕累托图）", desc: "一种特殊的条形图，条形按频数从高到低排列，同时叠加累积频率曲线，用于识别最重要的类别。" },
                { name: "Dot Plot（点图）", desc: "用于展示定量变量分布的图形，每个数据点用一个点表示，点在数轴上的位置对应数据值，点的数量表示频数。" },
                { name: "Stem-and-Leaf Plot（茎叶图）", desc: "将每个数据值分为茎（高位数字）和叶（低位数字），茎按顺序排列，叶在相应茎的右侧，既保留原始数据又展示分布形状。" },
                { name: "Histogram（直方图）", desc: "用于展示连续型定量变量分布的图形，横轴划分为连续区间（组距），纵轴表示每个区间内的频数或频率，区间之间无间隔。" },
                { name: "Relative Frequency（相对频率）", desc: "某一类别或区间的频数除以总观测数，通常以比例或百分比表示，反映该类别在总体中所占的比例。" },
                { name: "Shape of a Distribution（分布形状）", desc: "数据分布的外观特征，包括：对称型、偏斜型（左偏/右偏）、是否有峰值（单峰/双峰/多峰）、是否有异常值等。" },
                { name: "Symmetric Distribution（对称分布）", desc: "沿着中心轴左右对称的分布，均值和中位数大致相等。例如：正态分布是典型的对称分布。" },
                { name: "Skewed Distribution（偏态分布）", desc: "不对称的分布：右偏分布（尾部向右延伸，均值>中位数）；左偏分布（尾部向左延伸，均值<中位数）。" },
                { name: "Unimodal, Bimodal, Multimodal（单峰、双峰、多峰）", desc: "分布中峰值的数量：单峰（一个明显的峰值）、双峰（两个明显的峰值）、多峰（两个以上的峰值）。" },
                { name: "Outlier（异常值）", desc: "与数据集中其他值相比明显偏大或偏小的观测值，可能是测量错误、数据录入错误或真实的极端值。" },
                { name: "Measures of Center（中心度量）", desc: "描述数据集中趋势的统计量，主要包括均值、中位数和众数，用于表示数据的典型值或中心位置。" },
                { name: "Mean（均值）", desc: "所有数据值的总和除以数据个数，是最常用的中心度量，但容易受异常值影响。计算公式：x̄ = (x₁ + x₂ + ... + xₙ)/n。" },
                { name: "Median（中位数）", desc: "将数据按大小排序后位于中间位置的值，不受极端值影响，适用于偏态分布数据。对于n个数据，位置为(n+1)/2。" },
                { name: "Mode（众数）", desc: "数据集中出现次数最多的值，可用于描述分类变量和定量变量的中心趋势，一个数据集可能有多个众数。" },
                { name: "Resistant Measure（抗干扰度量）", desc: "不易受极端值（异常值）影响的统计量，如中位数和四分位距是抗干扰的，而均值和极差则不是。" },
                { name: "Measures of Spread（离散程度度量）", desc: "描述数据分散或变异程度的统计量，包括极差、四分位距、方差和标准差等。" },
                { name: "Range（极差）", desc: "数据集中最大值与最小值之差，计算公式：Range = Max - Min，简单但受异常值影响大。" },
                { name: "Quartiles（四分位数）", desc: "将排序后的数据分为四等份的三个值：Q1（第一四分位数，25%位置）、Q2（第二四分位数，即中位数，50%位置）、Q3（第三四分位数，75%位置）。" },
                { name: "Interquartile Range (IQR)（四分位距）", desc: "第三四分位数与第一四分位数之差，计算公式：IQR = Q3 - Q1，用于描述中间50%数据的离散程度，不受异常值影响。" },
                { name: "Five-Number Summary（五数概括）", desc: "由最小值、Q1、中位数（Q2）、Q3和最大值组成的统计量集合，全面概括数据的分布特征。" },
                { name: "Boxplot（箱线图）", desc: "基于五数概括绘制的图形，展示数据的中心、离散程度和分布形状，箱子从Q1延伸到Q3，中线为中位数，须线通常延伸到1.5×IQR范围内的最值。" },
                { name: "Variance（方差）", desc: "各数据值与均值之差的平方的平均值，衡量数据的平均平方偏差，计算公式：s² = Σ(xᵢ - x̄)²/(n-1)（样本方差）。" },
                { name: "Standard Deviation（标准差）", desc: "方差的平方根，与原始数据具有相同的单位，更直观地衡量数据的平均偏差，计算公式：s = √s²。" },
                { name: "z-score（z分数）", desc: "衡量一个数据值距离均值多少个标准差的统计量，计算公式：z = (x - x̄)/s，用于比较不同数据集或不同变量的观测值相对位置。" },
                { name: "Empirical Rule（经验法则）", desc: "对于近似正态分布的数据：约68%的数据在均值±1个标准差范围内；约95%在±2个标准差范围内；约99.7%在±3个标准差范围内。" },
                { name: "Cumulative Relative Frequency Graph（累积相对频率图）", desc: "横轴为数据值，纵轴为累积相对频率（小于等于该值的数据比例）的图形，用于估计百分位数和数据分布情况。" },
                { name: "Percentile（百分位数）", desc: "表示在数据集中，有特定百分比的数据小于或等于该值。例如：第80百分位数是指有80%的数据小于或等于该值。" },
                { name: "Scatterplot（散点图）", desc: "用于展示两个定量变量之间关系的图形，每个点代表一对(x,y)值，点的位置由其x和y值确定，用于观察变量间的相关性、方向和形式。" },
                { name: "Correlation Coefficient (r)（相关系数）", desc: "衡量两个定量变量之间线性关系强度和方向的统计量，取值范围为[-1,1]，r>0为正相关，r<0为负相关，|r|越接近1，线性关系越强。" },
                { name: "Association（关联）", desc: "两个变量之间的某种关系，当一个变量的值变化时，另一个变量的值也倾向于以某种方式变化，关联不一定意味着因果关系。" },
                { name: "Positive Association（正关联）", desc: "两个变量之间的关系，当一个变量的值增加时，另一个变量的值也倾向于增加。例如：身高和体重通常呈正关联。" },
                { name: "Negative Association（负关联）", desc: "两个变量之间的关系，当一个变量的值增加时，另一个变量的值倾向于减少。例如：商品价格和销售量通常呈负关联。" },
                { name: "Strength of Association（关联强度）", desc: "描述两个变量之间关系密切程度的指标，对于线性关系，相关系数r的绝对值越接近1，关联强度越大。" },
                { name: "Linear Relationship（线性关系）", desc: "两个变量之间的关系可以用一条直线近似表示，散点图中的点大致围绕一条直线分布。" },
                { name: "Nonlinear Relationship（非线性关系）", desc: "两个变量之间的关系不能用直线近似表示，而呈现曲线或其他复杂形式，相关系数r可能无法准确衡量这种关系。" },
                { name: "Lurking Variable（潜伏变量）", desc: "未被研究但可能影响研究中变量关系的变量，可能导致两个变量之间出现虚假关联或掩盖真实关联。" }
            ],
            2: [
                { name: "Individuals（个体）", desc: "研究中所关注的对象或实体，可以是个人、动物、物品等。例如：在研究学生成绩时，每个学生就是一个个体。" },
                { name: "Variable（变量）", desc: "个体的某种特征，不同个体可能有不同的值。例如：在研究学生时，身高、体重、成绩等都是变量。" },
                { name: "Population（总体）", desc: "研究中所有感兴趣的个体的集合。例如：研究某中学学生的身高时，该中学的所有学生构成了总体。" },
                { name: "Sample（样本）", desc: "从总体中选取的一部分个体，用于代表总体进行研究。样本应具有代表性，以确保研究结果可以推广到总体。" },
                { name: "Parameter（参数）", desc: "描述总体特征的数值，通常是未知的，需要通过样本统计量来估计。例如：总体均值μ、总体比例p等。" },
                { name: "Statistic（统计量）", desc: "描述样本特征的数值，根据样本数据计算得到，用于估计总体参数。例如：样本均值x̄、样本比例p̂等。" },
                { name: "Census（普查）", desc: "对总体中的每一个个体都进行测量或调查的方法，可以获得总体参数的准确值，但通常成本高、耗时长。" },
                { name: "Sampling（抽样）", desc: "从总体中选取样本的过程，目的是通过对样本的研究来推断总体特征，相比普查更经济高效。" },
                { name: "Bias（偏差）", desc: "研究设计或实施过程中存在的系统性误差，导致统计量持续偏离其所要估计的参数，影响结果的准确性。" },
                { name: "Selection Bias（选择偏差）", desc: "由于样本选取方法不当，导致样本不能代表总体而产生的偏差。例如：仅调查上网人群的意见可能存在选择偏差。" },
                { name: "Voluntary Response Bias（自愿回应偏差）", desc: "当样本由自愿参与的个体组成时产生的偏差，通常自愿参与者与非参与者在某些方面存在差异，导致结果失真。" },
                { name: "Nonresponse Bias（无回应偏差）", desc: "由于部分被选中的个体未能参与调查或提供数据，而这些无回应者与回应者可能存在差异所产生的偏差。" },
                { name: "Response Bias（回应偏差）", desc: "由于问题设计、调查环境或受访者心理等原因，导致受访者提供不准确或不真实回答所产生的偏差。" },
                { name: "Random Sampling（随机抽样）", desc: "使总体中的每个个体都有已知的、非零的机会被选中进入样本的抽样方法，有助于减少偏差，提高样本的代表性。" },
                { name: "Simple Random Sample (SRS)（简单随机样本）", desc: "从总体中随机选取n个个体，使得总体中所有可能的n个个体的组合都有相等的被选中概率的抽样方法。" },
                { name: "Stratified Random Sample（分层随机样本）", desc: "将总体按某些特征分为若干层（strata），然后从每个层中独立地进行随机抽样，适用于总体内部差异较大的情况。" },
                { name: "Cluster Sample（整群样本）", desc: "将总体分为若干个群（clusters），随机选取部分群，并对选中群中的所有个体进行调查，适用于群内差异大而群间差异小的情况。" },
                { name: "Systematic Sample（系统样本）", desc: "将总体中的个体按某种顺序排列，随机选择一个起始点，然后按照固定间隔选取个体组成样本的抽样方法。" },
                { name: "Convenience Sample（便利样本）", desc: "基于便利性选取样本的非随机抽样方法，如调查容易接触到的个体，可能存在较大偏差，样本代表性差。" },
                { name: "Observational Study（观察性研究）", desc: "研究者仅观察和记录个体的特征和行为，不干预或操纵变量的研究方法，不能确定因果关系，只能发现关联。" },
                { name: "Experiment（实验）", desc: "研究者主动操纵一个或多个变量（处理），并观察其对其他变量的影响的研究方法，通过控制其他因素，可以推断因果关系。" },
                { name: "Experimental Unit（实验单元）", desc: "实验中接受处理的对象，可以是个体、物品或其他实体。例如：在药物试验中，每个参与的病人就是一个实验单元。" },
                { name: "Treatment（处理）", desc: "实验中研究者施加给实验单元的条件或干预。例如：在肥料试验中，不同种类或剂量的肥料就是不同的处理。" },
                { name: "Explanatory Variable（解释变量）", desc: "在实验中被研究者操纵或改变的变量，用于解释或预测其他变量的变化，也称为自变量。" },
                { name: "Response Variable（响应变量）", desc: "在实验中被观察或测量的变量，其变化被认为可能受到解释变量的影响，也称为因变量。" },
                { name: "Confounding Variable（混杂变量）", desc: "与解释变量和响应变量都相关的变量，可能导致对因果关系的错误推断，无法区分其与解释变量对响应变量的影响。" },
                { name: "Control Group（对照组）", desc: "在实验中不接受处理或接受标准处理的组，用于与接受处理的组进行比较，以评估处理效果。" },
                { name: "Placebo（安慰剂）", desc: "一种看起来与实际处理相似但没有实际效果的物质或处理，常用于对照实验中，以消除心理因素的影响。" },
                { name: "Placebo Effect（安慰剂效应）", desc: "由于参与者相信自己接受了有效处理而产生的对响应变量的影响，即使他们实际上接受的是安慰剂。" },
                { name: "Blinding（盲法）", desc: "在实验中不让参与者或研究者知道谁接受了何种处理的方法，用于减少偏见和心理因素对结果的影响。" },
                { name: "Single-Blind Experiment（单盲实验）", desc: "只有参与者不知道自己接受的是何种处理，而研究者知道的实验设计。" },
                { name: "Double-Blind Experiment（双盲实验）", desc: "参与者和研究者都不知道谁接受了何种处理的实验设计，能更有效地减少偏见。" },
                { name: "Random Assignment（随机分配）", desc: "将实验单元随机分配到不同处理组的过程，有助于确保各组在实验开始时具有可比性，减少混杂变量的影响。" },
                { name: "Replication（重复）", desc: "在实验中对每个处理进行多次重复的过程，即每个处理组包含多个实验单元，有助于提高实验结果的可靠性和精确度。" },
                { name: "Blocking（区组）", desc: "将实验单元按某些已知可能影响结果的特征分为若干区组（blocks），在每个区组内进行随机分配，以减少变异，提高实验效率。" },
                { name: "Completely Randomized Design（完全随机设计）", desc: "将所有实验单元完全随机地分配到不同处理组的实验设计，适用于实验单元较为同质的情况。" },
                { name: "Randomized Block Design（随机区组设计）", desc: "先将实验单元分为区组，再在每个区组内将单元随机分配到不同处理组的实验设计，可控制区组变量带来的变异。" },
                { name: "Matched Pairs Design（配对设计）", desc: "一种特殊的随机区组设计，每个区组包含两个相似的实验单元，分别接受两种处理；或对同一单元在处理前后进行测量，以减少个体差异的影响。" }
            ],
            3: [
                { name: "Random Phenomenon（随机现象）", desc: "在个别试验中结果不确定，但在大量重复试验中结果呈现出规律性的现象。例如：抛硬币的结果是随机现象。" },
                { name: "Outcome（结果）", desc: "随机现象的每一个可能的基本结果。例如：抛一枚骰子，可能的结果是1、2、3、4、5、6。" },
                { name: "Sample Space (S)（样本空间）", desc: "一个随机试验中所有可能结果的集合，通常用S表示。例如：抛一枚硬币的样本空间是S = {正面, 反面}。" },
                { name: "Event（事件）", desc: "样本空间的一个子集，即某些结果的集合。例如：抛骰子得到偶数的事件是{2, 4, 6}。" },
                { name: "Probability（概率）", desc: "衡量一个事件发生可能性大小的数值，取值范围为[0,1]，概率为0表示不可能发生，概率为1表示必然发生。" },
                { name: "Law of Large Numbers（大数定律）", desc: "随着试验次数的增加，事件发生的频率会越来越接近其真实概率。例如：抛硬币次数越多，正面朝上的频率越接近0.5。" },
                { name: "Simulation（模拟）", desc: "通过计算机或随机设备重复模拟随机现象的过程，用于估计事件的概率或研究随机现象的规律，尤其适用于难以用理论计算的情况。" },
                { name: "Basic Probability Rules（基本概率法则）", desc: "包括：1. 任何事件的概率在0到1之间；2. 必然事件的概率为1；3. 不可能事件的概率为0；4. 互斥事件的加法法则等。" },
                { name: "Complement of an Event（事件的补集）", desc: "样本空间中不属于该事件的所有结果组成的事件，记为A^c或Ā，P(A) + P(A^c) = 1。" },
                { name: "Mutually Exclusive Events（互斥事件）", desc: "不能同时发生的两个事件，即它们的交集为空集，P(A ∩ B) = 0，此时P(A ∪ B) = P(A) + P(B)。" },
                { name: "Addition Rule for Probability（概率加法法则）", desc: "对于任意两个事件A和B，P(A ∪ B) = P(A) + P(B) - P(A ∩ B)；对于互斥事件，简化为P(A ∪ B) = P(A) + P(B)。" },
                { name: "Independent Events（独立事件）", desc: "一个事件的发生不影响另一个事件发生的概率的两个事件，满足P(A ∩ B) = P(A) × P(B)。" },
                { name: "Dependent Events（相依事件）", desc: "一个事件的发生会影响另一个事件发生的概率的两个事件，不满足独立性条件，即P(A ∩ B) ≠ P(A) × P(B)。" },
                { name: "Conditional Probability（条件概率）", desc: "在已知一个事件B发生的条件下，另一个事件A发生的概率，记为P(A|B)，计算公式：P(A|B) = P(A ∩ B) / P(B)，其中P(B) > 0。" },
                { name: "General Multiplication Rule（一般乘法法则）", desc: "对于任意两个事件A和B，P(A ∩ B) = P(A|B) × P(B) = P(B|A) × P(A)。" },
                { name: "Tree Diagram（树状图）", desc: "用于表示多步随机过程中所有可能结果及其概率的图形，每个分支代表一个可能的结果，分支上标注相应的概率，适用于计算复合事件的概率。" },
                { name: "Venn Diagram（维恩图）", desc: "用圆圈表示事件的图形，圆圈的大小和位置表示事件的概率和关系（如交集、并集、补集），有助于直观理解概率关系。" },
                { name: "Two-Way Table（双向表）", desc: "用于展示两个分类变量数据分布的表格，行表示一个变量的类别，列表示另一个变量的类别，单元格中的数值为相应组合的频数，可用于计算条件概率和判断独立性。" },
                { name: "Joint Probability（联合概率）", desc: "两个事件同时发生的概率，即P(A ∩ B)，在双向表中对应于某个单元格的频数除以总频数。" },
                { name: "Marginal Probability（边缘概率）", desc: "仅涉及一个变量的概率，通过双向表中边缘合计（行合计或列合计）除以总频数得到，如P(A)或P(B)。" },
                { name: "Conditional Distribution（条件分布）", desc: "在给定某个条件下（如某个事件发生或某个变量取特定值），另一个变量的概率分布，通过固定行或列计算相对频率得到。" },
                { name: "Independence in Two-Way Tables（双向表中的独立性）", desc: "若对于双向表中的所有单元格，都有P(A ∩ B) = P(A) × P(B)，则两个分类变量独立；即条件分布与边缘分布一致。" }
            ],
            4: [
                { name: "Random Variable（随机变量）", desc: "将随机试验的结果映射为数值的变量，用大写字母表示（如X、Y），分为离散型随机变量和连续型随机变量。" },
                { name: "Discrete Random Variable（离散随机变量）", desc: "取值为有限个或可数无穷多个的随机变量，通常是计数结果。例如：抛硬币正面朝上的次数、一家商店每天的顾客数等。" },
                { name: "Continuous Random Variable（连续随机变量）", desc: "可以在一个区间内取任何值的随机变量，通常是测量结果。例如：一个人的身高、一件产品的寿命等。" },
                { name: "Probability Distribution of a Discrete Random Variable（离散随机变量的概率分布）", desc: "描述离散随机变量所有可能取值及其对应概率的集合，通常用表格、公式或图形表示，满足所有概率之和为1。" },
                { name: "Probability Histogram（概率直方图）", desc: "用于展示离散随机变量概率分布的图形，横轴为随机变量的可能取值，纵轴为相应的概率，每个取值用一个矩形条表示。" },
                { name: "Expected Value (Mean) of a Discrete Random Variable（离散随机变量的期望值/均值）", desc: "衡量离散随机变量中心趋势的指标，计算公式：E(X) = μₓ = Σ[x × P(X = x)]，即所有可能取值与其概率的加权平均。" },
                { name: "Variance of a Discrete Random Variable（离散随机变量的方差）", desc: "衡量离散随机变量取值分散程度的指标，计算公式：Var(X) = σₓ² = Σ[(x - μₓ)² × P(X = x)] = E(X²) - [E(X)]²。" },
                { name: "Standard Deviation of a Discrete Random Variable（离散随机变量的标准差）", desc: "方差的平方根，与随机变量具有相同的单位，计算公式：σₓ = √Var(X)。" },
                { name: "Law of Large Numbers for Expected Value（期望值的大数定律）", desc: "随着试验次数的增加，随机变量的样本均值会越来越接近其期望值μₓ。" },
                { name: "Linear Transformation of a Random Variable（随机变量的线性变换）", desc: "对于随机变量X和常数a、b，新的随机变量Y = aX + b称为X的线性变换，其均值和方差满足：μᵧ = aμₓ + b，σᵧ² = a²σₓ²，σᵧ = |a|σₓ。" },
                { name: "Adding/Subtracting Random Variables（随机变量的加减）", desc: "对于两个随机变量X和Y，新的随机变量Z = X + Y（或Z = X - Y）的均值满足：μ_z = μₓ + μᵧ（或μ_z = μₓ - μᵧ）；若X和Y独立，方差满足：σ_z² = σₓ² + σᵧ²（减法时方差也相加）。" },
                { name: "Independent Random Variables（独立随机变量）", desc: "两个随机变量的取值互不影响，即对于所有可能的x和y，都有P(X = x, Y = y) = P(X = x) × P(Y = y)。" },
                { name: "Binomial Setting（二项分布场景）", desc: "满足以下条件的随机试验：1. 固定次数n的独立试验；2. 每次试验只有两种可能结果（成功或失败）；3. 每次试验成功的概率p相同；4. 关注的是n次试验中成功的次数X。" },
                { name: "Binomial Random Variable（二项随机变量）", desc: "在二项分布场景中，n次试验中成功的次数X，记为X ~ B(n, p)，其中n为试验次数，p为每次试验成功的概率。" },
                { name: "Binomial Probability Formula（二项概率公式）", desc: "二项随机变量X取k值的概率：P(X = k) = C(n, k) × pᵏ × (1-p)ⁿ⁻ᵏ，其中C(n, k)为组合数，表示从n次试验中选择k次成功的方式数。" },
                { name: "Mean of a Binomial Random Variable（二项随机变量的均值）", desc: "计算公式：μₓ = np，其中n为试验次数，p为每次试验成功的概率。" },
                { name: "Variance and Standard Deviation of a Binomial Random Variable（二项随机变量的方差和标准差）", desc: "方差：σₓ² = np(1-p)；标准差：σₓ = √[np(1-p)]。" },
                { name: "Geometric Setting（几何分布场景）", desc: "满足以下条件的随机试验：1. 独立试验；2. 每次试验只有两种可能结果（成功或失败）；3. 每次试验成功的概率p相同；4. 关注的是直到第一次成功为止所进行的试验次数X。" },
                { name: "Geometric Random Variable（几何随机变量）", desc: "在几何分布场景中，直到第一次成功为止所进行的试验次数X，记为X ~ Geom(p)，其中p为每次试验成功的概率。" },
                { name: "Geometric Probability Formula（几何概率公式）", desc: "几何随机变量X取k值的概率：P(X = k) = (1-p)ᵏ⁻¹ × p，其中k = 1, 2, 3, ...，表示前k-1次失败，第k次成功。" },
                { name: "Mean of a Geometric Random Variable（几何随机变量的均值）", desc: "计算公式：μₓ = 1/p，即直到第一次成功平均需要1/p次试验。" },
                { name: "Variance and Standard Deviation of a Geometric Random Variable（几何随机变量的方差和标准差）", desc: "方差：σₓ² = (1-p)/p²；标准差：σₓ = √[(1-p)/p²] = √(1-p)/p。" },
                { name: "Probability Distribution of a Continuous Random Variable（连续随机变量的概率分布）", desc: "用概率密度函数（pdf）描述，函数图像与横轴之间的面积表示概率，具有以下性质：1. 密度函数非负；2. 总面积为1；3. 单点概率为0，P(X = a) = 0。" },
                { name: "Normal Distribution（正态分布）", desc: "一种常见的连续概率分布，其概率密度函数呈钟形，对称于均值μ，由均值μ和标准差σ完全确定，记为X ~ N(μ, σ²)。" },
                { name: "Standard Normal Distribution（标准正态分布）", desc: "均值μ = 0，标准差σ = 1的正态分布，记为Z ~ N(0, 1)，任何正态分布都可以通过标准化转换为标准正态分布。" },
                { name: "Z-score（Z分数）", desc: "将正态随机变量标准化的转换：Z = (X - μ)/σ，Z表示X距离均值μ有多少个标准差，服从标准正态分布。" },
                { name: "Empirical Rule for Normal Distribution（正态分布的经验法则）", desc: "对于X ~ N(μ, σ²)：约68%的数据在μ ± σ范围内；约95%在μ ± 2σ范围内；约99.7%在μ ± 3σ范围内。" },
                { name: "Normal Probability Plot（正态概率图）", desc: "用于判断数据是否近似服从正态分布的图形，将数据值与标准正态分布的分位数对应绘制，若点大致落在一条直线上，则数据近似正态分布。" }
            ]
        };

        // 全局变量
        let selectedUnits = [1, 2, 3, 4]; // 默认选中所有单元
        let drawnConcepts = []; // 已抽取的概念记录
        let selectedSeconds = 60; // 默认倒计时时间（秒）- 1分钟
        let countdownInterval; // 倒计时计时器

        // DOM元素
        const randomBtn = document.getElementById('randomBtn');
        const nextBtn = document.getElementById('nextBtn');
        const conceptCard = document.getElementById('conceptCard');
        const initialHint = document.getElementById('initialHint');
        const conceptUnit = document.getElementById('conceptUnit');
        const conceptName = document.getElementById('conceptName');
        const conceptDesc = document.getElementById('conceptDesc');
        const conceptCount = document.getElementById('conceptCount');
        const historyList = document.getElementById('historyList');
        const selectAllBtn = document.getElementById('selectAll');
        const deselectAllBtn = document.getElementById('deselectAll');
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        const timerOptions = document.querySelectorAll('.timer-option');
        const timerContainer = document.getElementById('timerContainer');
        const explanationContainer = document.getElementById('explanationContainer');
        const countdownDisplay = document.getElementById('countdown');
        const timerBar = document.getElementById('timerBar');
        const showNowBtn = document.getElementById('showNowBtn');

        // 更新选中的单元
        function updateSelectedUnits() {
            selectedUnits = [];
            checkboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    selectedUnits.push(parseInt(checkbox.value));
                }
            });
        }

        // 设置倒计时时间
        timerOptions.forEach(option => {
            option.addEventListener('click', () => {
                // 播放点击音效
                playSound(clickSound);
                
                // 更新选中状态
                timerOptions.forEach(opt => {
                    opt.classList.remove('timer-btn-active');
                    opt.classList.add('timer-btn-inactive');
                });
                option.classList.remove('timer-btn-inactive');
                option.classList.add('timer-btn-active');
                
                // 保存选中的秒数
                selectedSeconds = parseInt(option.dataset.seconds);
            });
        });

        // 开始倒计时
        function startCountdown() {
            // 如果选择直接显示，则不启动倒计时
            if (selectedSeconds === 0) {
                showExplanation();
                return;
            }
            
            // 清除可能存在的计时器
            clearInterval(countdownInterval);
            
            // 显示计时器，隐藏解释
            timerContainer.classList.remove('hidden');
            explanationContainer.classList.add('hidden');
            
            let secondsLeft = selectedSeconds;
            updateCountdownDisplay(secondsLeft);
            
            // 设置计时器
            countdownInterval = setInterval(() => {
                secondsLeft--;
                updateCountdownDisplay(secondsLeft);
                
                if (secondsLeft <= 0) {
                    clearInterval(countdownInterval);
                    // 播放计时结束音效
                    playSound(timerEndSound);
                    showExplanation();
                }
            }, 1000);
        }

        // 更新倒计时显示
        function updateCountdownDisplay(seconds) {
            // 格式化时间显示（MM:SS）
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            countdownDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            
            // 更新进度条
            const percentage = (seconds / selectedSeconds) * 100;
            timerBar.style.width = `${percentage}%`;
            
            // 进度条颜色变化（从绿色到红色）
            if (percentage > 50) {
                timerBar.classList.remove('bg-yellow-500', 'bg-red-500');
                timerBar.classList.add('bg-green-500');
            } else if (percentage > 20) {
                timerBar.classList.remove('bg-green-500', 'bg-red-500');
                timerBar.classList.add('bg-yellow-500');
            } else {
                timerBar.classList.remove('bg-green-500', 'bg-yellow-500');
                timerBar.classList.add('bg-red-500');
            }
        }

        // 显示解释
        function showExplanation() {
            timerContainer.classList.add('hidden');
            explanationContainer.classList.remove('hidden');
        }

        // 随机抽取概念
        function drawRandomConcept() {
            updateSelectedUnits();
            
            if (selectedUnits.length === 0) {
                alert('请至少选择一个单元');
                return;
            }

            // 收集所有可选概念
            let availableConcepts = [];
            selectedUnits.forEach(unit => {
                statsConcepts[unit].forEach(concept => {
                    // 检查是否已抽取（避免重复）
                    const isDrawn = drawnConcepts.some(c => 
                        c.unit === unit && c.name === concept.name
                    );
                    if (!isDrawn) {
                        availableConcepts.push({...concept, unit});
                    }
                });
            });

            // 如果所有概念都已抽取，则重置
            if (availableConcepts.length === 0) {
                drawnConcepts = [];
                selectedUnits.forEach(unit => {
                    statsConcepts[unit].forEach(concept => {
                        availableConcepts.push({...concept, unit});
                    });
                });
            }

            // 随机选择一个概念
            const randomIndex = Math.floor(Math.random() * availableConcepts.length);
            const selectedConcept = availableConcepts[randomIndex];
            
            // 播放抽取音效
            playSound(drawSound);
            
            // 显示概念
            displayConcept(selectedConcept);
            
            // 添加到历史记录
            addToHistory(selectedConcept);
            
            // 更新计数
            drawnConcepts.push(selectedConcept);
            updateCount();
            
            // 开始倒计时
            startCountdown();
        }

        // 显示概念
        function displayConcept(concept) {
            // 显示卡片，隐藏初始提示
            conceptCard.classList.remove('hidden');
            initialHint.classList.add('hidden');
            
            // 更新内容
            const unitClass = `unit${concept.unit}`;
            const unitNames = {
                1: "单元1：探索数据",
                2: "单元2：实验设计",
                3: "单元3：概率基础",
                4: "单元4：概率分布"
            };
            
            conceptUnit.textContent = unitNames[concept.unit];
            conceptUnit.className = `text-sm font-bold px-3 py-1 rounded-full inline-block mb-3 bg-${unitClass}/10 text-${unitClass}`;
            conceptName.textContent = concept.name;
            conceptDesc.textContent = concept.desc;
            
            // 添加动画效果
            conceptCard.classList.remove('animate-pop');
            void conceptCard.offsetWidth; // 重置动画
            conceptCard.classList.add('animate-pop');
        }

        // 添加到历史记录
        function addToHistory(concept) {
            const historyItem = document.createElement('div');
            const unitClass = `unit${concept.unit}`;
            
            historyItem.className = `bg-gray-50 rounded-lg p-3 border-l-4 border-${unitClass} card-hover`;
            historyItem.innerHTML = `
                <div class="text-xs font-bold text-${unitClass} mb-1">${concept.unit}单元</div>
                <div class="font-medium">${concept.name}</div>
            `;
            
            // 点击历史记录项可重新查看该概念
            historyItem.addEventListener('click', () => {
                playSound(clickSound);
                displayConcept(concept);
                // 直接显示解释，不启动倒计时
                timerContainer.classList.add('hidden');
                explanationContainer.classList.remove('hidden');
            });
            
            // 添加到历史列表开头
            if (historyList.querySelector('.text-gray-500')) {
                historyList.innerHTML = '';
            }
            historyList.prepend(historyItem);
        }

        // 更新计数
        function updateCount() {
            // 计算总可选概念数
            let totalConcepts = 0;
            selectedUnits.forEach(unit => {
                totalConcepts += statsConcepts[unit].length;
            });
            
            conceptCount.textContent = `已抽取：${drawnConcepts.length}/${totalConcepts}`;
        }

        // 全选
        selectAllBtn.addEventListener('click', () => {
            playSound(clickSound);
            checkboxes.forEach(checkbox => {
                checkbox.checked = true;
            });
            updateSelectedUnits();
        });

        // 全不选
        deselectAllBtn.addEventListener('click', () => {
            playSound(clickSound);
            checkboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
            updateSelectedUnits();
        });

        // 立即查看按钮
        showNowBtn.addEventListener('click', () => {
            playSound(clickSound);
            clearInterval(countdownInterval);
            showExplanation();
        });

        // 事件监听
        randomBtn.addEventListener('click', drawRandomConcept);
        nextBtn.addEventListener('click', drawRandomConcept);
        
        // 为复选框添加音效
        checkboxes.forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                playSound(clickSound);
                updateSelectedUnits();
            });
        });

        // 初始化
        updateCount();
    </script>
</body>
</html>
    