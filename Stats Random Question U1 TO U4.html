<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AP统计学概念抽取器（1-4单元）</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        // 配置Tailwind自定义样式
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF', // 主色调：蓝色（专业感）
                        unit1: '#FF6B35',   // 单元1：橙色
                        unit2: '#2ECC71',   // 单元2：绿色
                        unit3: '#9B59B6',   // 单元3：紫色
                        unit4: '#3498DB',   // 单元4：亮蓝
                    },
                    fontFamily: {
                        comic: ['"Comic Sans MS"', 'cursive', 'sans-serif'],
                    },
                    animation: {
                        'bounce-slow': 'bounce 2s infinite',
                        'spin-slow': 'spin 3s linear infinite',
                        'pop': 'pop 0.5s ease-out',
                    },
                    keyframes: {
                        pop: {
                            '0%': { transform: 'scale(0.8)', opacity: '0' },
                            '50%': { transform: 'scale(1.1)' },
                            '100%': { transform: 'scale(1)', opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            }
            .card-hover {
                @apply transition-all duration-300 hover:shadow-xl hover:-translate-y-1;
            }
            .btn-custom {
                @apply rounded-full px-6 py-3 font-bold text-white shadow-lg transition-all duration-300 hover:shadow-xl hover:-translate-y-0.5;
            }
            .timer-btn {
                @apply px-4 py-2 rounded-lg transition-all text-center font-medium;
            }
            .timer-btn-active {
                @apply bg-primary text-white;
            }
            .timer-btn-inactive {
                @apply bg-primary/20 hover:bg-primary/40 text-primary;
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-50 min-h-screen font-comic">
    <!-- 音效元素 -->
    <audio id="drawSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.mp3" type="audio/mpeg">
    </audio>
    <audio id="timerEndSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3" type="audio/mpeg">
    </audio>
    <audio id="clickSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3" type="audio/mpeg">
    </audio>

    <!-- 页面头部 -->
    <header class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4 flex flex-col md:flex-row justify-between items-center">
            <div class="flex items-center mb-4 md:mb-0">
                <i class="fa fa-bar-chart text-primary text-4xl mr-3 animate-spin-slow"></i>
                <h1 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold text-primary text-shadow">
                    AP统计学概念抽取器
                </h1>
            </div>
            <div class="text-sm text-gray-500">
                <p>共4个单元 · 172个核心概念</p>
            </div>
        </div>
    </header>

    <!-- 主要内容区 -->
    <main class="container mx-auto px-4 py-8">
        <!-- 筛选与抽取区 -->
        <section class="mb-12 bg-white rounded-2xl shadow-lg p-6">
            <div class="flex flex-col md:flex-row gap-6">
                <!-- 单元筛选 -->
                <div class="w-full md:w-1/3 bg-gray-50 rounded-xl p-5">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fa fa-list-ul text-primary mr-2"></i>选择单元
                    </h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                        <!-- 单元1 -->
                        <label class="flex items-center p-3 rounded-lg border-2 border-transparent hover:border-unit1 cursor-pointer transition-all">
                            <input type="checkbox" value="1" class="form-checkbox h-5 w-5 text-unit1 mr-2" checked>
                            <span class="font-medium text-unit1">单元1：探索单变量数据</span>
                        </label>
                        <!-- 单元2 -->
                        <label class="flex items-center p-3 rounded-lg border-2 border-transparent hover:border-unit2 cursor-pointer transition-all">
                            <input type="checkbox" value="2" class="form-checkbox h-5 w-5 text-unit2 mr-2" checked>
                            <span class="font-medium text-unit2">单元2：探索双变量数据</span>
                        </label>
                        <!-- 单元3 -->
                        <label class="flex items-center p-3 rounded-lg border-2 border-transparent hover:border-unit3 cursor-pointer transition-all">
                            <input type="checkbox" value="3" class="form-checkbox h-5 w-5 text-unit3 mr-2" checked>
                            <span class="font-medium text-unit3">单元3：收集数据</span>
                        </label>
                        <!-- 单元4 -->
                        <label class="flex items-center p-3 rounded-lg border-2 border-transparent hover:border-unit4 cursor-pointer transition-all">
                            <input type="checkbox" value="4" class="form-checkbox h-5 w-5 text-unit4 mr-2" checked>
                            <span class="font-medium text-unit4">单元4：概率与分布</span>
                        </label>
                    </div>
                    
                    <!-- 倒计时设置 -->
                    <div class="mt-6">
                        <h3 class="text-lg font-bold text-gray-800 mb-3 flex items-center">
                            <i class="fa fa-clock-o text-primary mr-2"></i>显示设置
                        </h3>
                        <p class="text-sm text-gray-600 mb-2">概念解释的显示方式：</p>
                        <div class="flex flex-wrap gap-2">
                            <button class="timer-option timer-btn timer-btn-inactive" data-seconds="30">30秒后显示</button>
                            <button class="timer-option timer-btn timer-btn-active" data-seconds="60">1分钟后显示</button>
                            <button class="timer-option timer-btn timer-btn-inactive" data-seconds="120">2分钟后显示</button>
                            <button class="timer-option timer-btn timer-btn-inactive" data-seconds="0">直接显示</button>
                        </div>
                    </div>
                    
                    <div class="mt-4 flex gap-3">
                        <button id="selectAll" class="btn-custom bg-primary/80 hover:bg-primary">
                            <i class="fa fa-check-square-o mr-1"></i>全选
                        </button>
                        <button id="deselectAll" class="btn-custom bg-gray-500 hover:bg-gray-600">
                            <i class="fa fa-square-o mr-1"></i>全不选
                        </button>
                    </div>
                </div>

                <!-- 抽取按钮与结果显示 -->
                <div class="w-full md:w-2/3 flex flex-col items-center justify-center">
                    <button id="randomBtn" class="btn-custom bg-primary text-[clamp(1rem,2vw,1.25rem)] px-10 py-4 mb-8 animate-bounce-slow">
                        <i class="fa fa-random mr-2"></i>随机抽取概念
                    </button>

                    <!-- 概念结果卡片 -->
                    <div id="conceptCard" class="w-full bg-white rounded-xl shadow-lg border-4 border-primary/30 p-6 card-hover hidden animate-pop">
                        <div id="conceptUnit" class="text-sm font-bold px-3 py-1 rounded-full inline-block mb-3 bg-primary/10 text-primary">
                            单元1：探索单变量数据
                        </div>
                        <h3 id="conceptName" class="text-[clamp(1.5rem,3vw,2rem)] font-bold text-gray-800 mb-4 text-center">
                            Categorical Variable（分类变量）
                        </h3>
                        
                        <!-- 倒计时区域 -->
                        <div id="timerContainer" class="bg-yellow-50 rounded-lg p-4 mb-4 hidden">
                            <h4 class="font-bold text-yellow-700 mb-2 flex items-center">
                                <i class="fa fa-hourglass-half mr-2"></i>概念解释将在：
                            </h4>
                            <div class="flex items-center">
                                <span id="countdown" class="text-2xl font-bold text-yellow-600">01:00</span>
                                <div class="w-full ml-4 bg-gray-200 rounded-full h-2.5">
                                    <div id="timerBar" class="bg-yellow-500 h-2.5 rounded-full transition-all duration-1000" style="width: 100%"></div>
                                </div>
                            </div>
                            <button id="showNowBtn" class="mt-2 text-sm text-blue-600 hover:underline">
                                <i class="fa fa-eye mr-1"></i>立即查看
                            </button>
                        </div>
                        
                        <!-- 解释区域 -->
                        <div id="explanationContainer" class="bg-gray-50 rounded-lg p-4 mb-4 hidden">
                            <h4 class="font-bold text-gray-700 mb-2 flex items-center">
                                <i class="fa fa-book text-primary mr-2"></i>概念解释：
                            </h4>
                            <p id="conceptDesc" class="text-gray-600">
                                描述个体的类别或分组的变量，其值为标签或名称，而非数字。例如：性别（男/女）、血型（A/B/AB/O）等。
                            </p>
                        </div>
                        
                        <div class="flex justify-between items-center">
                            <span id="conceptCount" class="text-gray-500">
                                已抽取：0/172
                            </span>
                            <button id="nextBtn" class="btn-custom bg-primary/90 hover:bg-primary">
                                <i class="fa fa-refresh mr-1"></i>再抽一个
                            </button>
                        </div>
                    </div>

                    <!-- 初始提示 -->
                    <div id="initialHint" class="text-center text-gray-500 py-10">
                        <i class="fa fa-lightbulb-o text-5xl text-primary/50 mb-4"></i>
                        <p class="text-xl">选择要抽取的单元，点击上方按钮开始随机抽取</p>
                        <p class="mt-2">每个概念包含单元分类、英文名称和详细解释</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 已抽取概念记录 -->
        <section class="bg-white rounded-2xl shadow-lg p-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                <i class="fa fa-history text-primary mr-2"></i>已抽取概念记录
            </h2>
            <div id="historyList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 max-h-64 overflow-y-auto p-2">
                <div class="text-gray-500 text-center col-span-full py-8">
                    暂无抽取记录，开始抽取后将显示在这里
                </div>
            </div>
        </section>
    </main>

    <!-- 页脚 -->
    <footer class="bg-gray-800 text-white py-6 mt-12">
        <div class="container mx-auto px-4 text-center">
            <p class="mb-2">AP统计学概念随机抽取器 | 1-4单元专用版</p>
            <p class="text-sm text-gray-400">设计目标：帮助学生快速记忆统计学核心概念</p>
        </div>
    </footer>

    <script>
        // 音效元素
        const drawSound = document.getElementById('drawSound');
        const timerEndSound = document.getElementById('timerEndSound');
        const clickSound = document.getElementById('clickSound');
        
        // 播放音效的函数
        function playSound(sound) {
            // 克隆音效元素以允许连续播放
            const clone = sound.cloneNode();
            clone.play().catch(e => console.log("Audio play failed:", e));
            // 播放结束后清理
            clone.addEventListener('ended', () => clone.remove());
        }

        // 统计学概念数据（1-4单元）- 根据提供的列表更新
        const statsConcepts = {
            1: [
                { name: "variables（变量）", desc: "描述个体特征的可测量属性，其值可能因个体而异。" },
                { name: "categorical variable（分类变量）", desc: "描述个体所属类别的变量，其值为非数值型的标签或名称。" },
                { name: "quantitative variable（定量变量）", desc: "取值为数值的变量，这些数值具有数学意义，可以进行计算和比较。" },
                { name: "frequency（频数）", desc: "某个类别或数值在数据集中出现的次数。" },
                { name: "relative frequency（相对频数）", desc: "某类别频数与总观测数的比值，反映该类别在总体中所占的比例。" },
                { name: "proportion（比例）", desc: "表示总体中具有某种特征的部分占总体的分数值，取值范围为[0,1]。" },
                { name: "rates（比率）", desc: "两个相关数量的比值，通常用于表示某种现象发生的频率，如发生率、死亡率等。" },
                { name: "percentages（百分比）", desc: "将比例乘以100得到的数值，表示每100个单位中包含的特定部分的数量。" },
                { name: "bar charts（条形图）", desc: "用矩形条表示分类数据的图形，条的长度或高度与类别对应的频数或频率成正比。" },
                { name: "frequency tables（频数表）", desc: "将数据按类别或区间分组，并记录每个组的频数的表格，用于汇总数据。" },
                { name: "discrete variable（离散变量）", desc: "只能取特定数值的定量变量，通常是计数结果，数值之间存在间隔。" },
                { name: "continuous variable（连续变量）", desc: "可以在一个区间内取任何数值的定量变量，通常是测量结果，可以无限细分。" },
                { name: "histogram（直方图）", desc: "用于展示连续型定量变量分布的图形，横轴为数据区间，纵轴为每个区间的频数或频率。" },
                { name: "interval widths（区间宽度）", desc: "直方图中每个区间的长度，区间宽度的选择会影响直方图的形状。" },
                { name: "describe distribution（描述分布）", desc: "分析数据分布的主要特征，包括形状、中心、离散程度和异常特征。" },
                { name: "shape（形状）", desc: "数据分布的外观特征，如对称、偏斜、单峰、多峰等。" },
                { name: "center（中心）", desc: "数据分布的中心位置，通常用均值、中位数等统计量来描述。" },
                { name: "variability（离散性）", desc: "数据值之间的分散程度，反映数据的变异情况。" },
                { name: "unusual features（异常特征）", desc: "数据分布中不常见的特征，如异常值、间隙、聚类等。" },
                { name: "outliers（异常值）", desc: "与数据集中其他值相比明显偏大或偏小的观测值。" },
                { name: "gaps（间隙）", desc: "数据分布中没有观测值的区域。" },
                { name: "clusters（聚类）", desc: "数据集中观测值密集分布的区域。" },
                { name: "multiple peaks（多峰）", desc: "数据分布中存在多个明显的峰值，表明数据可能来自多个不同的群体。" },
                { name: "skewed to the right（右偏）", desc: "数据分布的尾部向右延伸，均值大于中位数。" },
                { name: "positive skew（正偏）", desc: "即右偏分布，指数据集中大部分值集中在左侧，右侧有少数较大的值。" },
                { name: "skewed to the left（左偏）", desc: "数据分布的尾部向左延伸，均值小于中位数。" },
                { name: "negative skew（负偏）", desc: "即左偏分布，指数据集中大部分值集中在右侧，左侧有少数较小的值。" },
                { name: "symmetric（对称）", desc: "数据分布围绕中心轴左右对称，均值和中位数大致相等。" },
                { name: "uni-variate（单变量）", desc: "仅涉及一个变量的数据或分析。" },
                { name: "bimodal（双峰）", desc: "具有两个明显峰值的分布，表明数据可能来自两个不同的群体。" },
                { name: "uni-modal（单峰）", desc: "具有一个明显峰值的分布，表明数据集中在一个主要的中心区域。" },
                { name: "conjectures（推测）", desc: "基于数据观察提出的假设或推测，需要进一步验证。" },
                { name: "statistic（统计量）", desc: "描述样本特征的数值，如样本均值、样本标准差等。" },
                { name: "mean（均值）", desc: "所有数据值的总和除以数据个数，是常用的中心度量。" },
                { name: "median（中位数）", desc: "将数据按大小排序后位于中间位置的值，不受极端值影响。" },
                { name: "Q1（第一四分位数）", desc: "将排序后的数据分为四等份，位于25%位置的值，表示有25%的数据小于或等于该值。" },
                { name: "first quartile（第一四分位数）", desc: "同Q1，将数据分为四等份，处于25%位置的数值。" },
                { name: "third quartile（第三四分位数）", desc: "同Q3，将数据分为四等份，处于75%位置的数值。" },
                { name: "Q3（第三四分位数）", desc: "将排序后的数据分为四等份，位于75%位置的值，表示有75%的数据小于或等于该值。" },
                { name: "pth percentile（第p百分位数）", desc: "表示在数据集中，有p%的数据小于或等于该值。" },
                { name: "inter-quartile range（四分位距）", desc: "第三四分位数与第一四分位数之差（IQR = Q3 - Q1），描述中间50%数据的离散程度。" },
                { name: "standard deviation（标准差）", desc: "方差的平方根，衡量数据偏离均值的平均程度，与原始数据单位相同。" },
                { name: "variance（方差）", desc: "各数据值与均值之差的平方的平均值，衡量数据的离散程度。" },
                { name: "nonresistant（非抗干扰的）", desc: "容易受极端值影响的统计量，如均值和极差。" },
                { name: "five-number summary（五数概括）", desc: "由最小值、Q1、中位数、Q3和最大值组成的统计量集合，用于描述数据分布。" },
                { name: "box-plot（箱线图）", desc: "基于五数概括绘制的图形，展示数据的中心、离散程度和分布形状。" },
                { name: "whiskers（须线）", desc: "箱线图中从箱子延伸出来的线，通常表示数据的范围（除去异常值）。" },
                { name: "side-by-side box plots（并列箱线图）", desc: "将多个箱线图并排绘制，用于比较不同组数据的分布特征。" },
                { name: "parameter（参数）", desc: "描述总体特征的数值，通常是未知的，需要通过样本统计量来估计。" },
                { name: "normal distribution model（正态分布模型）", desc: "一种对称的钟形分布，许多自然现象都近似遵循正态分布。" },
                { name: "empirical rule（经验法则）", desc: "对于正态分布，约68%的数据在均值±1个标准差范围内，约95%在±2个标准差范围内，约99.7%在±3个标准差范围内。" },
                { name: "standardized score（标准化分数）", desc: "即z分数，衡量一个数据值距离均值多少个标准差的位置。" },
                { name: "z-score（z分数）", desc: "计算公式为z = (x - μ)/σ，用于比较不同数据集中的观测值相对位置。" },
                { name: "area of a region under the graph of density curve（密度曲线下某区域的面积）", desc: "表示数据落在该区域内的概率，整个密度曲线下的面积为1。" }
            ],
            2: [
                { name: "side-by-side bar graphs（并列条形图）", desc: "将多个条形图并排绘制，用于比较不同组的分类数据分布。" },
                { name: "segmented bar graph（分段条形图）", desc: "用一个条形的不同分段表示总体中不同类别的比例，便于比较各类别在不同组中的相对比例。" },
                { name: "mosaic plots（马赛克图）", desc: "用于展示两个分类变量关系的图形，矩形的面积与相应类别的频数成比例。" },
                { name: "two-way table（双向表）", desc: "展示两个分类变量数据分布的表格，行表示一个变量的类别，列表示另一个变量的类别。" },
                { name: "contingency table（列联表）", desc: "即双向表，用于分析两个分类变量之间的关系。" },
                { name: "joint relative frequency（联合相对频数）", desc: "双向表中某个单元格的频数与总频数的比值，表示两个变量同时取特定值的比例。" },
                { name: "marginal relative frequencies（边缘相对频数）", desc: "双向表中行合计或列合计与总频数的比值，只涉及一个变量的分布。" },
                { name: "conditional relative frequency（条件相对频数）", desc: "在给定某个变量取特定值的条件下，另一个变量取某值的相对频数。" },
                { name: "check for independence/association in two-way table（在双向表中检验独立性/关联性）", desc: "通过比较条件分布和边缘分布，判断两个分类变量是否独立或存在关联。" },
                { name: "bi-variate（双变量）", desc: "涉及两个变量的数据或分析，用于研究两个变量之间的关系。" },
                { name: "scatter-plot（散点图）", desc: "用点表示两个定量变量观测值的图形，每个点代表一对(x,y)值，用于观察变量间的关系。" },
                { name: "explanatory variable（解释变量）", desc: "被认为可能影响其他变量的变量，通常在散点图的横轴上表示。" },
                { name: "response variable（响应变量）", desc: "被认为可能受其他变量影响的变量，通常在散点图的纵轴上表示。" },
                { name: "describe scatter plot: FUDS（描述散点图：FUDS）", desc: "FUDS指Form（形式）、Unusual features（异常特征）、Direction（方向）、Strength（强度），是描述散点图的四个维度。" },
                { name: "describe form in scatter plot（描述散点图的形式）", desc: "指变量间关系的形状，如线性、非线性（曲线等）。" },
                { name: "direction in describing the scatter plot（描述散点图的方向）", desc: "指变量间关系的趋势，如正相关（一个变量增加，另一个也增加）或负相关（一个变量增加，另一个减少）。" },
                { name: "strength in describing the scatter plot（描述散点图的强度）", desc: "指变量间关系的密切程度，点越集中在某种模式周围，关系越强。" },
                { name: "unusual features in the scatter plot（散点图中的异常特征）", desc: "如异常点（远离整体模式的点）、聚类等。" },
                { name: "positive or negative direction（正方向或负方向）", desc: "正方向指变量同增同减，负方向指一个变量增加而另一个减少。" },
                { name: "linear / nonlinear form（线性/非线性形式）", desc: "线性形式指变量间关系可用直线近似，非线性形式则需要曲线等其他形式描述。" },
                { name: "strong, moderate, or weak（强、中、弱）", desc: "描述变量间关系的密切程度，相关系数的绝对值接近1为强，接近0为弱。" },
                { name: "correlation, r interpretation（相关系数r的解释）", desc: "相关系数r衡量两个定量变量线性关系的强度和方向，取值范围为[-1,1]，r>0为正相关，r<0为负相关，|r|越接近1关系越强。" },
                { name: "correlation does not necessarily imply causation（相关不一定意味着因果）", desc: "两个变量相关可能是由于巧合、共同的潜在变量影响，不一定存在直接的因果关系。" },
                { name: "predicted response（预测响应值）", desc: "根据回归模型对响应变量的估计值。" },
                { name: "y-intercept（y轴截距）", desc: "回归直线与y轴的交点，当解释变量为0时响应变量的预测值。" },
                { name: "slope (b) interpretation（斜率b的解释）", desc: "表示解释变量每增加一个单位，响应变量的平均变化量。" },
                { name: "extrapolate（外推）", desc: "使用回归模型预测超出数据范围的解释变量对应的响应变量值，存在较大不确定性。" },
                { name: "residual（残差）", desc: "观测值与预测值之间的差异，计算公式为残差 = 观测值 - 预测值。" },
                { name: "residual plot（残差图）", desc: "以解释变量为横轴、残差为纵轴的散点图，用于评估回归模型的适用性。" },
                { name: "apparent randomness in a residual plot（残差图中的明显随机性）", desc: "如果残差图呈现随机分布，无明显模式，说明线性模型是合适的。" },
                { name: "appropriateness of a selected model（所选模型的适用性）", desc: "评估模型是否能很好地拟合数据，如线性模型是否适合描述变量间的关系。" },
                { name: "least-squares regression model (LSRL)（最小二乘回归模型）", desc: "使残差平方和最小的回归直线，是最常用的线性回归模型。" },
                { name: "mean point (x̄,ȳ) on LSRL（LSRL上的均值点）", desc: "回归直线一定经过点(x̄,ȳ)，即解释变量均值和响应变量均值组成的点。" },
                { name: "interpret coefficient of determination（解释决定系数）", desc: "决定系数R²表示响应变量的变异中可由解释变量通过线性关系解释的比例，取值范围为[0,1]。" },
                { name: "high-leverage points（高杠杆点）", desc: "解释变量值远离其均值的点，可能对回归直线产生较大影响。" },
                { name: "outlier in linear regression（线性回归中的异常值）", desc: "残差较大的点，即观测值与模型预测值差异较大的点。" },
                { name: "influential（有影响力的）", desc: "如果移除某个点会显著改变回归模型（如斜率、截距），则该点是有影响力的点。" },
                { name: "write down LSRL based on computer output（根据计算机输出写出LSRL）", desc: "从统计软件输出中提取斜率和截距，写出回归方程ŷ = a + bx。" },
                { name: "transformations（变换）", desc: "对变量进行数学变换（如对数、平方根变换），使非线性关系转化为线性关系，以便使用线性回归模型。" },
                { name: "increased randomness in residual plots（残差图中增加的随机性）", desc: "变量变换后，残差图更接近随机分布，表明变换后的模型更合适。" }
            ],
            3: [
                { name: "population（总体）", desc: "研究中所有感兴趣的个体的集合。" },
                { name: "sample（样本）", desc: "从总体中选取的一部分个体，用于代表总体进行研究。" },
                { name: "observational（观察性的）", desc: "指观察性研究，研究者不干预变量，仅观察和记录数据。" },
                { name: "treatments（处理）", desc: "实验中施加给实验单元的条件或干预，用于观察其对响应变量的影响。" },
                { name: "retrospective（回顾性的）", desc: "指回顾性研究，通过回顾过去的数据来探索变量间的关系。" },
                { name: "prospective（前瞻性的）", desc: "指前瞻性研究，追踪研究对象在未来一段时间内的情况，收集数据。" },
                { name: "sample survey（抽样调查）", desc: "通过对样本的调查来获取关于总体信息的方法。" },
                { name: "experimental units（实验单元）", desc: "实验中接受处理的对象，可以是个体、物品等。" },
                { name: "generalizations（推广）", desc: "将样本研究结果推广到更大总体的过程，要求样本具有代表性。" },
                { name: "representative（有代表性的）", desc: "指样本的特征与总体的特征相似，能够反映总体的情况。" },
                { name: "randomly selected（随机选择的）", desc: "采用随机方法选取样本，使每个个体都有被选中的机会，提高样本代表性。" },
                { name: "causal relationship（因果关系）", desc: "一个变量的变化直接导致另一个变量变化的关系，通常需要通过实验来确定。" },
                { name: "sampling without replacement（不放回抽样）", desc: "从总体中抽取一个个体后，不再将其放回总体，因此每个个体最多被选中一次。" },
                { name: "simple random sample（简单随机样本）", desc: "使总体中所有可能的样本都有相等的被选中概率的抽样方法。" },
                { name: "stratified random sample（分层随机样本）", desc: "将总体分为若干层，从每层中随机抽样，适用于总体内部差异较大的情况。" },
                { name: "homogeneous grouping（同质分组）", desc: "将具有相似特征的个体分为一组，如分层抽样中的层内个体具有同质性。" },
                { name: "cluster sample（整群样本）", desc: "将总体分为若干群，随机选取部分群，并对选中群中的所有个体进行调查。" },
                { name: "heterogeneity（异质性）", desc: "指群体内部存在较大差异，整群抽样适用于群内异质性高而群间同质性高的情况。" },
                { name: "systematic random sample（系统随机样本）", desc: "将总体按某种顺序排列，随机选择起始点，然后按固定间隔选取个体组成样本。" },
                { name: "census（普查）", desc: "对总体中的每一个个体都进行调查的方法，能获得总体的准确信息，但成本高。" },
                { name: "bias（偏差）", desc: "研究设计或实施过程中存在的系统性误差，导致结果偏离真实情况。" },
                { name: "voluntary response bias（自愿回应偏差）", desc: "样本由自愿参与的个体组成时产生的偏差，自愿参与者可能与总体存在差异。" },
                { name: "under-coverage bias（覆盖不足偏差）", desc: "由于抽样框架未能包含总体中的某些部分，导致这些部分未被纳入样本而产生的偏差。" },
                { name: "non-response bias（无回应偏差）", desc: "部分被选中的个体未能参与调查，且无回应者与回应者存在差异而产生的偏差。" },
                { name: "question wording bias（问题措辞偏差）", desc: "由于问题表述方式不当，引导受访者给出特定答案而产生的偏差。" },
                { name: "self-reported responses（自我报告回应）", desc: "由受访者自行报告的信息，可能存在记忆错误或故意歪曲的情况。" },
                { name: "non-random（非随机的）", desc: "指非随机抽样方法，样本选取不遵循随机原则，可能导致偏差。" },
                { name: "convenience sampling（便利抽样）", desc: "选取容易接触到的个体作为样本的非随机抽样方法，样本代表性差。" },
                { name: "factor（因子）", desc: "实验中可能影响结果的变量，研究者通常会操纵因子的不同水平。" },
                { name: "confounding variable（混杂变量）", desc: "与解释变量和响应变量都相关的变量，可能干扰对因果关系的判断。" },
                { name: "four principles of good experimental design（良好实验设计的四原则）", desc: "包括对比、随机分配、重复和控制，以确保实验结果的可靠性和有效性。" },
                { name: "comparisons of at least two treatments（至少两种处理的比较）", desc: "实验中需要比较不同处理的效果，通常包括处理组和对照组。" },
                { name: "random assignment / allocation（随机分配）", desc: "将实验单元随机分配到不同处理组，确保各组在实验开始时具有可比性。" },
                { name: "replication in experimental units（实验单元的重复）", desc: "每个处理组包含多个实验单元，以提高实验结果的可靠性。" },
                { name: "control of potential confounding variables（对潜在混杂变量的控制）", desc: "通过实验设计减少或消除混杂变量对结果的影响。" },
                { name: "completely randomized design（完全随机设计）", desc: "将所有实验单元随机分配到不同处理组的实验设计。" },
                { name: "balance the effects of confounding variables（平衡混杂变量的影响）", desc: "通过随机分配等方法，使混杂变量在不同处理组中的影响大致平衡。" },
                { name: "single-blind experiment（单盲实验）", desc: "参与者不知道自己接受的是何种处理，但研究者知道的实验设计。" },
                { name: "double-blind experiment（双盲实验）", desc: "参与者和研究者都不知道谁接受了何种处理的实验设计，能有效减少偏见。" },
                { name: "control group（对照组）", desc: "不接受处理或接受安慰剂处理的组，用于与处理组进行比较。" },
                { name: "placebo（安慰剂）", desc: "看起来与实际处理相似但没有实际效果的物质或处理，用于对照实验。" },
                { name: "randomized complete block designs（随机完全区组设计）", desc: "将实验单元分为区组，在每个区组内随机分配处理，以控制区组变量的影响。" },
                { name: "matched pairs design（配对设计）", desc: "将相似的实验单元配对，每对中的两个单元分别接受两种处理，以减少个体差异的影响。" },
                { name: "statistical inference（统计推断）", desc: "根据样本数据推断总体特征的过程，包括参数估计和假设检验。" },
                { name: "statistically significant（统计显著的）", desc: "指观察到的差异不太可能是由随机因素引起的，通常通过假设检验来判断。" }
            ],
            4: [
                { name: "random and non-random（随机的和非随机的）", desc: "随机指结果不确定但有规律性，非随机指结果确定或无规律。" },
                { name: "simulation（模拟）", desc: "通过计算机或随机设备重复模拟随机现象，用于估计概率或研究其规律。" },
                { name: "trial of a simulation（模拟试验）", desc: "模拟过程中的一次重复，对应随机现象的一次观测。" },
                { name: "outcome of trial（试验结果）", desc: "每次模拟试验得到的结果。" },
                { name: "law of large numbers（大数定律）", desc: "随着试验次数增加，事件发生的频率会越来越接近其真实概率。" },
                { name: "sample space（样本空间）", desc: "随机试验中所有可能结果的集合，通常用S表示。" },
                { name: "equally likely event（等可能事件）", desc: "在样本空间中，每个结果发生的概率相等的事件。" },
                { name: "probability of an event（事件的概率）", desc: "衡量事件发生可能性大小的数值，取值范围为[0,1]。" },
                { name: "complement of an event（事件的补集）", desc: "样本空间中不属于该事件的所有结果组成的事件，记为A^c，P(A) + P(A^c) = 1。" },
                { name: "probability and relative frequency（概率与相对频率）", desc: "概率是理论上的可能性，相对频率是实际观测中的比例，大数定律表明两者会趋于一致。" },
                { name: "mutually exclusive event（互斥事件）", desc: "不能同时发生的事件，即它们的交集为空集，P(A ∩ B) = 0。" },
                { name: "joint probability / intersection（联合概率/交集）", desc: "两个事件同时发生的概率，记为P(A ∩ B)。" },
                { name: "conditional probability（条件概率）", desc: "在已知事件B发生的条件下，事件A发生的概率，记为P(A|B) = P(A ∩ B) / P(B)。" },
                { name: "multiplication rule（乘法法则）", desc: "计算联合概率的法则：P(A ∩ B) = P(A|B) × P(B) = P(B|A) × P(A)。" },
                { name: "independent event（独立事件）", desc: "一个事件的发生不影响另一个事件发生的概率，满足P(A ∩ B) = P(A) × P(B)。" },
                { name: "union event（并集事件）", desc: "事件A或事件B发生的事件，记为A ∪ B。" },
                { name: "addition rule（加法法则）", desc: "计算并集概率的法则：P(A ∪ B) = P(A) + P(B) - P(A ∩ B)。" },
                { name: "interpretation of probability（概率的解释）", desc: "概率表示事件发生的长期相对频率，或对事件发生可能性的主观信念。" },
                { name: "probability distribution（概率分布）", desc: "描述随机变量所有可能取值及其对应概率的集合。" },
                { name: "discrete random variable（离散随机变量）", desc: "只能取有限个或可数无限个值的随机变量，如计数结果。" },
                { name: "properties of probability（概率的性质）", desc: "包括：概率在0到1之间；所有可能结果的概率和为1等。" },
                { name: "cumulative probability distribution（累积概率分布）", desc: "描述随机变量取值小于或等于某个值的概率的函数。" },
                { name: "describing probability distribution (S,U,V,C for population)（描述概率分布）", desc: "S（Shape，形状）、U（Unusual features，异常特征）、V（Variability，离散性）、C（Center，中心），用于描述总体的概率分布。" },
                { name: "parameter of population（总体参数）", desc: "描述总体概率分布特征的数值，如总体均值、总体标准差等。" },
                { name: "statistic of sample（样本统计量）", desc: "根据样本数据计算的描述样本特征的数值，用于估计总体参数。" },
                { name: "mean of discrete random variable（离散随机变量的均值）", desc: "即数学期望，是随机变量所有可能取值与其对应概率的乘积之和，反映随机变量的平均水平。" },
                { name: "standard deviation of discrete random variable（离散随机变量的标准差）", desc: "衡量离散随机变量取值分散程度的指标，是方差的平方根。" },
                { name: "interpretation of parameter of discrete random variable（离散随机变量参数的解释）", desc: "如均值表示长期重复试验中随机变量的平均结果，标准差表示结果的平均变异程度。" },
                { name: "linear combination of random variables aZ + bY（随机变量的线性组合aZ + bY）", desc: "由两个随机变量Z和Y通过线性运算得到的新随机变量。" },
                { name: "independent random variable（独立随机变量）", desc: "一个随机变量的取值不影响另一个随机变量的取值概率的两个随机变量。" },
                { name: "mean of the linear combination（线性组合的均值）", desc: "对于线性组合aX + bY，其均值为aμₓ + bμᵧ。" },
                { name: "standard deviation of linear combination（线性组合的标准差）", desc: "对于独立随机变量X和Y，线性组合aX + bY的标准差为√(a²σₓ² + b²σᵧ²)。" },
                { name: "effects of probability distribution Y = a + bX（概率分布Y = a + bX的影响）", desc: "a为常数项，使分布平移；b为系数，使分布伸缩，均值变为a + bμₓ，标准差变为|b|σₓ。" },
                { name: "binomial setting（二项分布场景）", desc: "满足以下条件的场景：n次独立试验；每次试验只有两种结果（成功或失败）；每次试验成功概率p相同。" },
                { name: "binomial random variable（二项随机变量）", desc: "在二项分布场景中，n次试验中成功的次数，记为X ~ B(n, p)。" },
                { name: "probability of binomial random variable (Bpd)（二项随机变量的概率）", desc: "二项分布的概率密度函数，计算恰好k次成功的概率：P(X=k) = C(n,k)pᵏ(1-p)ⁿ⁻ᵏ。" },
                { name: "probability of cumulative binomial random variable (Bcd)（二项随机变量的累积概率）", desc: "二项分布的累积分布函数，计算至多k次成功的概率：P(X≤k) = Σᵢ₌₀ᵏ C(n,i)pⁱ(1-p)ⁿ⁻ⁱ。" },
                { name: "expected value / mean of binomial random variable（二项随机变量的期望/均值）", desc: "μ = np，即n次试验中预期的成功次数。" },
                { name: "standard deviation of binomial random variable（二项随机变量的标准差）", desc: "σ = √[np(1-p)]，衡量成功次数的变异程度。" },
                { name: "geometric setting（几何分布场景）", desc: "满足以下条件的场景：一系列独立试验；每次试验只有两种结果（成功或失败）；每次试验成功概率p相同；关注首次成功时的试验次数。" },
                { name: "geometric random variable（几何随机变量）", desc: "在几何分布场景中，首次成功前的试验次数，记为X ~ G(p)。" },
                { name: "probability of geometric random variable (Gpd)（几何随机变量的概率）", desc: "几何分布的概率密度函数，计算首次成功发生在第k次试验的概率：P(X=k) = (1-p)ᵏ⁻¹p。" },
                { name: "probability of cumulative geometric random variable (Gcd)（几何随机变量的累积概率）", desc: "几何分布的累积分布函数，计算首次成功发生在第k次或更早试验的概率：P(X≤k) = 1 - (1-p)ᵏ。" },
                { name: "expected value of geometric random variable（几何随机变量的期望）", desc: "μ = 1/p，即首次成功前预期的试验次数。" },
                { name: "standard deviation of geometric random variable（几何随机变量的标准差）", desc: "σ = √[(1-p)/p²]，衡量首次成功前试验次数的变异程度。" },
                { name: "interpretation of geometric / binomial parameters（几何/二项分布参数的解释）", desc: "如二项分布中的p表示每次试验成功的概率，几何分布中的p表示每次试验成功的概率，1/p表示首次成功的平均试验次数。" }
            ]
        };

           // 全局变量
        let selectedUnits = [1, 2, 3, 4]; // 默认选中所有单元
        let drawnConcepts = []; // 已抽取的概念记录
        let currentTimer = null; // 当前计时器
        let selectedTime = 60; // 默认60秒后显示解释
        
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 获取DOM元素
            const randomBtn = document.getElementById('randomBtn');
            const nextBtn = document.getElementById('nextBtn');
            const selectAllBtn = document.getElementById('selectAll');
            const deselectAllBtn = document.getElementById('deselectAll');
            const showNowBtn = document.getElementById('showNowBtn');
            const timerOptions = document.querySelectorAll('.timer-option');
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            
            // 随机抽取按钮点击事件
            randomBtn.addEventListener('click', drawRandomConcept);
            nextBtn.addEventListener('click', drawRandomConcept);
            
            // 全选/全不选按钮
            selectAllBtn.addEventListener('click', function() {
                playSound(clickSound);
                checkboxes.forEach(checkbox => {
                    checkbox.checked = true;
                });
                updateSelectedUnits();
            });
            
            deselectAllBtn.addEventListener('click', function() {
                playSound(clickSound);
                checkboxes.forEach(checkbox => {
                    checkbox.checked = false;
                });
                updateSelectedUnits();
            });
            
            // 单元选择变化事件
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    playSound(clickSound);
                    updateSelectedUnits();
                });
            });
            
            // 计时器选项点击事件
            timerOptions.forEach(option => {
                option.addEventListener('click', function() {
                    playSound(clickSound);
                    timerOptions.forEach(opt => opt.classList.remove('timer-btn-active', 'timer-btn-inactive'));
                    timerOptions.forEach(opt => opt.classList.add('timer-btn-inactive'));
                    this.classList.remove('timer-btn-inactive');
                    this.classList.add('timer-btn-active');
                    selectedTime = parseInt(this.dataset.seconds);
                });
            });
            
            // 立即查看按钮点击事件
            showNowBtn.addEventListener('click', function() {
                playSound(clickSound);
                if (currentTimer) {
                    clearInterval(currentTimer);
                }
                showExplanation();
            });
            
            // 更新选中的单元
            function updateSelectedUnits() {
                selectedUnits = [];
                checkboxes.forEach(checkbox => {
                    if (checkbox.checked) {
                        selectedUnits.push(parseInt(checkbox.value));
                    }
                });
            }
            
            // 随机抽取概念
            function drawRandomConcept() {
                // 检查是否有选中的单元
                if (selectedUnits.length === 0) {
                    alert('请至少选择一个单元');
                    return;
                }
                
                playSound(drawSound);
                
                // 收集所有选中单元的概念
                let availableConcepts = [];
                selectedUnits.forEach(unit => {
                    statsConcepts[unit].forEach(concept => {
                        availableConcepts.push({
                            unit: unit,
                            name: concept.name,
                            desc: concept.desc
                        });
                    });
                });
                
                // 如果所有概念都已抽取，重置已抽取记录
                if (drawnConcepts.length >= availableConcepts.length) {
                    drawnConcepts = [];
                }
                
                // 随机选择一个未抽取过的概念
                let randomConcept;
                do {
                    const randomUnitIndex = Math.floor(Math.random() * selectedUnits.length);
                    const randomUnit = selectedUnits[randomUnitIndex];
                    const conceptIndex = Math.floor(Math.random() * statsConcepts[randomUnit].length);
                    randomConcept = {
                        unit: randomUnit,
                        name: statsConcepts[randomUnit][conceptIndex].name,
                        desc: statsConcepts[randomUnit][conceptIndex].desc
                    };
                } while (drawnConcepts.some(c => c.unit === randomConcept.unit && c.name === randomConcept.name));
                
                // 添加到已抽取记录
                drawnConcepts.push(randomConcept);
                
                // 显示概念卡片，隐藏初始提示
                document.getElementById('conceptCard').classList.remove('hidden');
                document.getElementById('initialHint').classList.add('hidden');
                
                // 更新概念信息
                const unitNames = {
                    1: "单元1：探索单变量数据",
                    2: "单元2：探索双变量数据",
                    3: "单元3：收集数据",
                    4: "单元4：概率与分布"
                };
                const unitColors = {
                    1: "unit1",
                    2: "unit2",
                    3: "unit3",
                    4: "unit4"
                };
                
                const conceptUnitEl = document.getElementById('conceptUnit');
                conceptUnitEl.textContent = unitNames[randomConcept.unit];
                conceptUnitEl.className = `text-sm font-bold px-3 py-1 rounded-full inline-block mb-3 bg-${unitColors[randomConcept.unit]}/10 text-${unitColors[randomConcept.unit]}`;
                
                document.getElementById('conceptName').textContent = randomConcept.name;
                document.getElementById('conceptDesc').textContent = randomConcept.desc;
                
                // 更新计数
                document.getElementById('conceptCount').textContent = `已抽取：${drawnConcepts.length}/${getTotalConceptsCount()}`;
                
                // 更新历史记录
                updateHistoryList();
                
                // 处理解释显示逻辑
                const timerContainer = document.getElementById('timerContainer');
                const explanationContainer = document.getElementById('explanationContainer');
                
                // 清除之前的计时器
                if (currentTimer) {
                    clearInterval(currentTimer);
                }
                
                // 根据选择的时间决定显示方式
                if (selectedTime === 0) {
                    // 直接显示解释
                    timerContainer.classList.add('hidden');
                    explanationContainer.classList.remove('hidden');
                } else {
                    // 倒计时后显示解释
                    explanationContainer.classList.add('hidden');
                    timerContainer.classList.remove('hidden');
                    
                    let secondsLeft = selectedTime;
                    updateTimerDisplay(secondsLeft);
                    
                    currentTimer = setInterval(() => {
                        secondsLeft--;
                        updateTimerDisplay(secondsLeft);
                        
                        if (secondsLeft <= 0) {
                            clearInterval(currentTimer);
                            playSound(timerEndSound);
                            showExplanation();
                        }
                    }, 1000);
                }
            }
            
            // 更新计时器显示
            function updateTimerDisplay(seconds) {
                const minutes = Math.floor(seconds / 60);
                const secs = seconds % 60;
                document.getElementById('countdown').textContent = `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                
                // 更新进度条
                const progress = (seconds / selectedTime) * 100;
                document.getElementById('timerBar').style.width = `${progress}%`;
            }
            
            // 显示解释
            function showExplanation() {
                document.getElementById('timerContainer').classList.add('hidden');
                document.getElementById('explanationContainer').classList.remove('hidden');
            }
            
            // 更新历史记录列表
            function updateHistoryList() {
                const historyList = document.getElementById('historyList');
                historyList.innerHTML = '';
                
                if (drawnConcepts.length === 0) {
                    historyList.innerHTML = `
                        <div class="text-gray-500 text-center col-span-full py-8">
                            暂无抽取记录，开始抽取后将显示在这里
                        </div>
                    `;
                    return;
                }
                
                // 倒序显示（最新的在前面）
                const reversedHistory = [...drawnConcepts].reverse();
                
                reversedHistory.forEach((concept, index) => {
                    const unitColors = {
                        1: "unit1",
                        2: "unit2",
                        3: "unit3",
                        4: "unit4"
                    };
                    
                    const historyItem = document.createElement('div');
                    historyItem.className = `bg-gray-50 rounded-lg p-3 border-l-4 border-${unitColors[concept.unit]} card-hover`;
                    historyItem.innerHTML = `
                        <div class="text-xs font-medium text-${unitColors[concept.unit]} mb-1">单元${concept.unit}</div>
                        <div class="text-sm font-medium text-gray-800 truncate">${concept.name}</div>
                        <div class="text-xs text-gray-500 mt-1">第${drawnConcepts.length - index}个</div>
                    `;
                    historyList.appendChild(historyItem);
                });
            }
            
            // 获取选中单元的总概念数
            function getTotalConceptsCount() {
                let count = 0;
                selectedUnits.forEach(unit => {
                    count += statsConcepts[unit].length;
                });
                return count;
            }
        });
    </script>
</body>
</html>
